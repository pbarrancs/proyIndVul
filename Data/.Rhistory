aport_var <- function(l)
{
lsum <- sum(l)
l/lsum
}
var <- aport_var(eig$values)
names(var) <- c("l1","l2","l3","l4","l5","l6")
plot(var,type="o",ylab = "Porcentaje de varianza expresada", xlab = "Componente")
fviz_screeplot(z,barfill = "purple",barcolor = "green",linecolor = "red",addlabels =TRUE)
fviz_screeplot(z,geom = "line",linecolor = "red" ,addlabels =TRUE)
fviz_pca_var(z,col.var="contrib")
gr1 <- fviz_contrib(z,choice = "var", axes = 1)
gr2 <- fviz_contrib(z,choice = "var", axes = 2)
grid.arrange(gr1, gr2, ncol = 2)
fviz_pca_ind(z,
col.ind = "cos2", # Color by the quality of representation
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE     # Avoid text overlapping
)
fviz_pca_biplot(z, repel = TRUE,
col.var = "#2E9FDF", # Variables color
col.ind = "#696969"  # Individuals color
)
indice <- function(df,vec){
n = length(df[,1])
ind = c()
for ( i in 1:n){
ind[i] = vec[1]*df[i,1] + vec[2]*df[i,2] + vec[3]*df[i,3] + vec[4]*df[i,4] +vec[5]*df[i,5] + vec[6]*df[i,6]
}
return(ind)
}
scores <- eig$vectors[,1]
ind <- indice(df,scores)
(ind <- sort(round(100/as.numeric(ind),3)))
View(df)
nomgeo <- c("Álvaro Obregón", "Azcapotzalco", "Benito Juárez", "Coyoacán", "Cuajimalpa de Morelos", "Cuauhtémoc", "Gustavo A. Madero","Iztacalco","Iztapalapa","La Magdalena Contreras", "Miguel Hidalgo", "Milpa Alta", "Tláhuac", "Tlalpan", "Venustiano Carranza", "Xochimilco")
index <- cbind(c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16),ind)
View(index)
indice <- function(df,vec){
n = length(df[,1])
ind = c()
for ( i in 1:n){
ind[i] = vec[1]*df[i,1] + vec[2]*df[i,2] + vec[3]*df[i,3] + vec[4]*df[i,4] +vec[5]*df[i,5] + vec[6]*df[i,6]
}
return(ind)
}
scores <- eig$vectors[,1]
ind <- indice(df,scores)
(ind <- round(100/as.numeric(ind),3))
nomgeo <- c("Álvaro Obregón", "Azcapotzalco", "Benito Juárez", "Coyoacán", "Cuajimalpa de Morelos", "Cuauhtémoc", "Gustavo A. Madero","Iztacalco","Iztapalapa","La Magdalena Contreras", "Miguel Hidalgo", "Milpa Alta", "Tláhuac", "Tlalpan", "Venustiano Carranza", "Xochimilco")
index <- cbind(c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16),ind)
View(df)
View(index)
nomgeo <- c("Álvaro Obregón", "Azcapotzalco", "Benito Juárez", "Coyoacán", "Cuajimalpa de Morelos", "Cuauhtémoc", "Gustavo A. Madero","Iztacalco","Iztapalapa","La Magdalena Contreras", "Miguel Hidalgo", "Milpa Alta", "Tláhuac", "Tlalpan", "Venustiano Carranza", "Xochimilco")
index <- cbind(nomgeo,ind)
mapa<-st_read("~/ITAM/Décimo/index/alcaldias/alcaldias.shp",stringsAsFactors=FALSE)
str(mapa)
mapa_datos <- inner_join(mapa,index, by="nomgeo")
View(index)
nomgeo <- c("Álvaro Obregón", "Azcapotzalco", "Benito Juárez", "Coyoacán", "Cuajimalpa de Morelos", "Cuauhtémoc", "Gustavo A. Madero","Iztacalco","Iztapalapa","La Magdalena Contreras", "Miguel Hidalgo", "Milpa Alta", "Tláhuac", "Tlalpan", "Venustiano Carranza", "Xochimilco")
index <- merge(nomgeo,ind)
View(index)
View(index)
nomgeo <- c("Álvaro Obregón", "Azcapotzalco", "Benito Juárez", "Coyoacán", "Cuajimalpa de Morelos", "Cuauhtémoc", "Gustavo A. Madero","Iztacalco","Iztapalapa","La Magdalena Contreras", "Miguel Hidalgo", "Milpa Alta", "Tláhuac", "Tlalpan", "Venustiano Carranza", "Xochimilco")
index <- data.frame(nomgeo,ind)
View(index)
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c('rgdal', 'factoextra', 'gridExtra','sf', 'ggplot2', 'tmap', 'tmaptools', 'leaflet','dplyr')
lapply(libs, instalar)
options(scipen=999)
df<- read.csv("BD.csv")
df[,5:13]<-df[,5:13]/df[,3]
df[,13]<-df[,13]*1000 #Remuneración en miles de pesos
df[,15]<-df[,15]/100
df <- df[,-c(1,2,3,4,8,9,10,12,14,15)]
names(df) <- c("X1","X2","X3","X4","X5","X6") #Todas las variables estan en terminos poblacionales
attr(df$X1, "descripcion") <- "Ingresos Inferiores. "
attr(df$X2, "descripcion") <- "Carencia de Alimentos."
attr(df$X3, "descripcion") <- "Carencia de Salud."
attr(df$X4, "descripcion") <- "Personal medico"
attr(df$X5, "descripcion") <- "Remuneracion (miles de pesos)"
attr(df$X6, "descripcion") <- "Promedio años de escolaridad"
#str(df)
head(df)
#solo para comparar y para fines graficos
z <- princomp(df,cor = T)
summary(z, loadings=T)
(R <- round(cor(df),3))
eig <- eigen(R)
(y <- round(eig$vectors,3)*-1) #lo multiplicamos por -1 simplemente por interpretacion
aport_var <- function(l)
{
lsum <- sum(l)
l/lsum
}
var <- aport_var(eig$values)
names(var) <- c("l1","l2","l3","l4","l5","l6")
plot(var,type="o",ylab = "Porcentaje de varianza expresada", xlab = "Componente")
fviz_screeplot(z,barfill = "purple",barcolor = "green",linecolor = "red",addlabels =TRUE)
fviz_screeplot(z,geom = "line",linecolor = "red" ,addlabels =TRUE)
fviz_pca_var(z,col.var="contrib")
gr1 <- fviz_contrib(z,choice = "var", axes = 1)
gr2 <- fviz_contrib(z,choice = "var", axes = 2)
grid.arrange(gr1, gr2, ncol = 2)
fviz_pca_ind(z,
col.ind = "cos2", # Color by the quality of representation
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE     # Avoid text overlapping
)
fviz_pca_biplot(z, repel = TRUE,
col.var = "#2E9FDF", # Variables color
col.ind = "#696969"  # Individuals color
)
indice <- function(df,vec){
n = length(df[,1])
ind = c()
for ( i in 1:n){
ind[i] = vec[1]*df[i,1] + vec[2]*df[i,2] + vec[3]*df[i,3] + vec[4]*df[i,4] +vec[5]*df[i,5] + vec[6]*df[i,6]
}
return(ind)
}
scores <- eig$vectors[,1]
ind <- indice(df,scores)
(ind <- round(100/as.numeric(ind),3))
nomgeo <- c("Álvaro Obregón", "Azcapotzalco", "Benito Juárez", "Coyoacán", "Cuajimalpa de Morelos", "Cuauhtémoc", "Gustavo A. Madero","Iztacalco","Iztapalapa","La Magdalena Contreras", "Miguel Hidalgo", "Milpa Alta", "Tláhuac", "Tlalpan", "Venustiano Carranza", "Xochimilco")
index <- data.frame(nomgeo,ind)
mapa<-st_read("~/ITAM/Décimo/index/alcaldias/alcaldias.shp",stringsAsFactors=FALSE)
str(mapa)
mapa_datos <- inner_join(mapa,index, by="nomgeo")
str(mapa_datos)
tmap_mode("view")
tmap_last()
tmap_mode("view")
tmap_last()
mapa<-st_read("~/ITAM/Décimo/index/alcaldias/alcaldias.shp",stringsAsFactors=FALSE)
str(mapa)
mapa_datos <- inner_join(mapa,index, by="nomgeo")
str(mapa_datos)
tmap_mode("view")
tmap_last()
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c('rgdal', 'factoextra', 'gridExtra','sf', 'ggplot2', 'tmap', 'tmaptools', 'leaflet','dplyr')
lapply(libs, instalar)
options(scipen=999)
tmap_mode("view")
tmap_last()
tmap_mode("plot")
tmap_last()
tmap_mode("view")
tmap_last()
tmap_mode(current.mode)
tmap_mode("view")
tmap_last()
indice <- function(df,vec){
n = length(df[,1])
ind = c()
for ( i in 1:n){
ind[i] = vec[1]*df[i,1] + vec[2]*df[i,2] + vec[3]*df[i,3] + vec[4]*df[i,4] +vec[5]*df[i,5] + vec[6]*df[i,6]
}
return(ind)
}
scores <- eig$vectors[,1]
ind <- indice(df,scores)
(ind <- round(100/as.numeric(ind),3))
nomgeo <- c("Álvaro Obregón", "Azcapotzalco", "Benito Juárez", "Coyoacán", "Cuajimalpa de Morelos", "Cuauhtémoc", "Gustavo A. Madero","Iztacalco","Iztapalapa","La Magdalena Contreras", "Miguel Hidalgo", "Milpa Alta", "Tláhuac", "Tlalpan", "Venustiano Carranza", "Xochimilco")
index <- data.frame(nomgeo,ind)
mapa<-st_read("~/ITAM/Décimo/index/alcaldias/alcaldias.shp",stringsAsFactors=FALSE)
str(mapa)
mapa_datos <- inner_join(mapa,index, by="nomgeo")
str(mapa_datos)
View(index)
tm_shape(mapa_datos)+
tm_polygons("ind",id="nomgeo",plette="Reds")
tmap_mode("view")
tmap_last()
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c('rgdal', 'factoextra', 'gridExtra','sf', 'ggplot2', 'tmap', 'tmaptools', 'leaflet','dplyr')
lapply(libs, instalar)
options(scipen=999)
df<- read.csv("BD.csv")
df[,5:13]<-df[,5:13]/df[,3]
df[,13]<-df[,13]*1000 #Remuneración en miles de pesos
df[,15]<-df[,15]/100
df <- df[,-c(1,2,3,4,8,9,10,12,14,15)]
names(df) <- c("X1","X2","X3","X4","X5","X6") #Todas las variables estan en terminos poblacionales
attr(df$X1, "descripcion") <- "Ingresos Inferiores. "
attr(df$X2, "descripcion") <- "Carencia de Alimentos."
attr(df$X3, "descripcion") <- "Carencia de Salud."
attr(df$X4, "descripcion") <- "Personal medico"
attr(df$X5, "descripcion") <- "Remuneracion (miles de pesos)"
attr(df$X6, "descripcion") <- "Promedio años de escolaridad"
#str(df)
head(df)
#solo para comparar y para fines graficos
z <- princomp(df,cor = T)
summary(z, loadings=T)
(R <- round(cor(df),3))
eig <- eigen(R)
(y <- round(eig$vectors,3)*-1) #lo multiplicamos por -1 simplemente por interpretacion
aport_var <- function(l)
{
lsum <- sum(l)
l/lsum
}
var <- aport_var(eig$values)
names(var) <- c("l1","l2","l3","l4","l5","l6")
plot(var,type="o",ylab = "Porcentaje de varianza expresada", xlab = "Componente")
fviz_screeplot(z,barfill = "purple",barcolor = "green",linecolor = "red",addlabels =TRUE)
fviz_screeplot(z,geom = "line",linecolor = "red" ,addlabels =TRUE)
fviz_pca_var(z,col.var="contrib")
gr1 <- fviz_contrib(z,choice = "var", axes = 1)
gr2 <- fviz_contrib(z,choice = "var", axes = 2)
grid.arrange(gr1, gr2, ncol = 2)
fviz_pca_ind(z,
col.ind = "cos2", # Color by the quality of representation
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE     # Avoid text overlapping
)
fviz_pca_biplot(z, repel = TRUE,
col.var = "#2E9FDF", # Variables color
col.ind = "#696969"  # Individuals color
)
indice <- function(df,vec){
n = length(df[,1])
ind = c()
for ( i in 1:n){
ind[i] = vec[1]*df[i,1] + vec[2]*df[i,2] + vec[3]*df[i,3] + vec[4]*df[i,4] +vec[5]*df[i,5] + vec[6]*df[i,6]
}
return(ind)
}
scores <- eig$vectors[,1]
ind <- indice(df,scores)
(ind <- round(100/as.numeric(ind),3))
nomgeo <- c("Álvaro Obregón", "Azcapotzalco", "Benito Juárez", "Coyoacán", "Cuajimalpa de Morelos", "Cuauhtémoc", "Gustavo A. Madero","Iztacalco","Iztapalapa","La Magdalena Contreras", "Miguel Hidalgo", "Milpa Alta", "Tláhuac", "Tlalpan", "Venustiano Carranza", "Xochimilco")
index <- data.frame(nomgeo,ind)
mapa<-st_read("alcaldias.shp",stringsAsFactors=FALSE)
setwd("~/ITAM/Décimo/index/proyIndVul/Data")
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c('rgdal', 'factoextra', 'gridExtra','sf', 'ggplot2', 'tmap', 'tmaptools', 'leaflet','dplyr')
lapply(libs, instalar)
options(scipen=999)
df<- read.csv("BD.csv")
df[,5:13]<-df[,5:13]/df[,3]
df[,13]<-df[,13]*1000 #Remuneración en miles de pesos
df[,15]<-df[,15]/100
df <- df[,-c(1,2,3,4,8,9,10,12,14,15)]
names(df) <- c("X1","X2","X3","X4","X5","X6") #Todas las variables estan en terminos poblacionales
attr(df$X1, "descripcion") <- "Ingresos Inferiores. "
attr(df$X2, "descripcion") <- "Carencia de Alimentos."
attr(df$X3, "descripcion") <- "Carencia de Salud."
attr(df$X4, "descripcion") <- "Personal medico"
attr(df$X5, "descripcion") <- "Remuneracion (miles de pesos)"
attr(df$X6, "descripcion") <- "Promedio años de escolaridad"
#str(df)
head(df)
#solo para comparar y para fines graficos
z <- princomp(df,cor = T)
summary(z, loadings=T)
(R <- round(cor(df),3))
eig <- eigen(R)
(y <- round(eig$vectors,3)*-1) #lo multiplicamos por -1 simplemente por interpretacion
aport_var <- function(l)
{
lsum <- sum(l)
l/lsum
}
var <- aport_var(eig$values)
names(var) <- c("l1","l2","l3","l4","l5","l6")
plot(var,type="o",ylab = "Porcentaje de varianza expresada", xlab = "Componente")
fviz_screeplot(z,barfill = "purple",barcolor = "green",linecolor = "red",addlabels =TRUE)
fviz_screeplot(z,geom = "line",linecolor = "red" ,addlabels =TRUE)
fviz_pca_var(z,col.var="contrib")
gr1 <- fviz_contrib(z,choice = "var", axes = 1)
gr2 <- fviz_contrib(z,choice = "var", axes = 2)
grid.arrange(gr1, gr2, ncol = 2)
fviz_pca_ind(z,
col.ind = "cos2", # Color by the quality of representation
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE     # Avoid text overlapping
)
fviz_pca_biplot(z, repel = TRUE,
col.var = "#2E9FDF", # Variables color
col.ind = "#696969"  # Individuals color
)
indice <- function(df,vec){
n = length(df[,1])
ind = c()
for ( i in 1:n){
ind[i] = vec[1]*df[i,1] + vec[2]*df[i,2] + vec[3]*df[i,3] + vec[4]*df[i,4] +vec[5]*df[i,5] + vec[6]*df[i,6]
}
return(ind)
}
scores <- eig$vectors[,1]
ind <- indice(df,scores)
(ind <- round(100/as.numeric(ind),3))
nomgeo <- c("Álvaro Obregón", "Azcapotzalco", "Benito Juárez", "Coyoacán", "Cuajimalpa de Morelos", "Cuauhtémoc", "Gustavo A. Madero","Iztacalco","Iztapalapa","La Magdalena Contreras", "Miguel Hidalgo", "Milpa Alta", "Tláhuac", "Tlalpan", "Venustiano Carranza", "Xochimilco")
index <- data.frame(nomgeo,ind)
mapa<-st_read("alcaldias.shp",stringsAsFactors=FALSE)
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c('rgdal', 'factoextra', 'gridExtra','sf', 'ggplot2', 'tmap', 'tmaptools', 'leaflet','dplyr')
lapply(libs, instalar)
options(scipen=999)
df<- read.csv("BD.csv")
df[,5:13]<-df[,5:13]/df[,3]
df[,13]<-df[,13]*1000 #Remuneración en miles de pesos
df[,15]<-df[,15]/100
df <- df[,-c(1,2,3,4,8,9,10,12,14,15)]
names(df) <- c("X1","X2","X3","X4","X5","X6") #Todas las variables estan en terminos poblacionales
attr(df$X1, "descripcion") <- "Ingresos Inferiores. "
attr(df$X2, "descripcion") <- "Carencia de Alimentos."
attr(df$X3, "descripcion") <- "Carencia de Salud."
attr(df$X4, "descripcion") <- "Personal medico"
attr(df$X5, "descripcion") <- "Remuneracion (miles de pesos)"
attr(df$X6, "descripcion") <- "Promedio años de escolaridad"
#str(df)
head(df)
#solo para comparar y para fines graficos
z <- princomp(df,cor = T)
summary(z, loadings=T)
(R <- round(cor(df),3))
eig <- eigen(R)
(y <- round(eig$vectors,3)*-1) #lo multiplicamos por -1 simplemente por interpretacion
aport_var <- function(l)
{
lsum <- sum(l)
l/lsum
}
var <- aport_var(eig$values)
names(var) <- c("l1","l2","l3","l4","l5","l6")
plot(var,type="o",ylab = "Porcentaje de varianza expresada", xlab = "Componente")
fviz_screeplot(z,barfill = "purple",barcolor = "green",linecolor = "red",addlabels =TRUE)
fviz_screeplot(z,geom = "line",linecolor = "red" ,addlabels =TRUE)
fviz_pca_var(z,col.var="contrib")
gr1 <- fviz_contrib(z,choice = "var", axes = 1)
gr2 <- fviz_contrib(z,choice = "var", axes = 2)
grid.arrange(gr1, gr2, ncol = 2)
fviz_pca_ind(z,
col.ind = "cos2", # Color by the quality of representation
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE     # Avoid text overlapping
)
fviz_pca_biplot(z, repel = TRUE,
col.var = "#2E9FDF", # Variables color
col.ind = "#696969"  # Individuals color
)
indice <- function(df,vec){
n = length(df[,1])
ind = c()
for ( i in 1:n){
ind[i] = vec[1]*df[i,1] + vec[2]*df[i,2] + vec[3]*df[i,3] + vec[4]*df[i,4] +vec[5]*df[i,5] + vec[6]*df[i,6]
}
return(ind)
}
scores <- eig$vectors[,1]
ind <- indice(df,scores)
(ind <- round(100/as.numeric(ind),3))
nomgeo <- c("Álvaro Obregón", "Azcapotzalco", "Benito Juárez", "Coyoacán", "Cuajimalpa de Morelos", "Cuauhtémoc", "Gustavo A. Madero","Iztacalco","Iztapalapa","La Magdalena Contreras", "Miguel Hidalgo", "Milpa Alta", "Tláhuac", "Tlalpan", "Venustiano Carranza", "Xochimilco")
index <- data.frame(nomgeo,ind)
mapa<-st_read("alcaldias.shp",stringsAsFactors=FALSE)
mapa<-st_read("~/alcaldias.shp",stringsAsFactors=FALSE)
mapa<-st_read("/alcaldias.shp",stringsAsFactors=FALSE)
mapa<-st_read("alcaldias.shp",stringsAsFactors=FALSE)
mapa<-st_read("alcaldias/alcaldias.shp",stringsAsFactors=FALSE)
str(mapa)
mapa_datos <- inner_join(mapa,index, by="nomgeo")
str(mapa_datos)
#Instalar las librerias necesarias y cargarlas
instalar <- function(paquete) {
if (!require(paquete,character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)){
install.packages(as.character(paquete),
dependecies = TRUE,
repos = "http://cran.us.r-project.org")
library(paquete,
character.only = TRUE,
quietly = TRUE,
warn.conflicts = FALSE)
}
}
libs <- c('rgdal', 'factoextra', 'gridExtra','sf', 'ggplot2', 'tmap', 'tmaptools', 'leaflet','dplyr')
lapply(libs, instalar)
options(scipen=999)
df<- read.csv("BD.csv")
df[,5:13]<-df[,5:13]/df[,3]
df[,13]<-df[,13]*1000 #Remuneración en miles de pesos
df[,15]<-df[,15]/100
df <- df[,-c(1,2,3,4,8,9,10,12,14,15)]
names(df) <- c("X1","X2","X3","X4","X5","X6") #Todas las variables estan en terminos poblacionales
attr(df$X1, "descripcion") <- "Ingresos Inferiores. "
attr(df$X2, "descripcion") <- "Carencia de Alimentos."
attr(df$X3, "descripcion") <- "Carencia de Salud."
attr(df$X4, "descripcion") <- "Personal medico"
attr(df$X5, "descripcion") <- "Remuneracion (miles de pesos)"
attr(df$X6, "descripcion") <- "Promedio años de escolaridad"
#str(df)
head(df)
#solo para comparar y para fines graficos
z <- princomp(df,cor = T)
summary(z, loadings=T)
(R <- round(cor(df),3))
eig <- eigen(R)
(y <- round(eig$vectors,3)*-1) #lo multiplicamos por -1 simplemente por interpretacion
aport_var <- function(l)
{
lsum <- sum(l)
l/lsum
}
var <- aport_var(eig$values)
names(var) <- c("l1","l2","l3","l4","l5","l6")
plot(var,type="o",ylab = "Porcentaje de varianza expresada", xlab = "Componente")
fviz_screeplot(z,barfill = "purple",barcolor = "green",linecolor = "red",addlabels =TRUE)
fviz_screeplot(z,geom = "line",linecolor = "red" ,addlabels =TRUE)
fviz_pca_var(z,col.var="contrib")
gr1 <- fviz_contrib(z,choice = "var", axes = 1)
gr2 <- fviz_contrib(z,choice = "var", axes = 2)
grid.arrange(gr1, gr2, ncol = 2)
fviz_pca_ind(z,
col.ind = "cos2", # Color by the quality of representation
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE     # Avoid text overlapping
)
fviz_pca_biplot(z, repel = TRUE,
col.var = "#2E9FDF", # Variables color
col.ind = "#696969"  # Individuals color
)
indice <- function(df,vec){
n = length(df[,1])
ind = c()
for ( i in 1:n){
ind[i] = vec[1]*df[i,1] + vec[2]*df[i,2] + vec[3]*df[i,3] + vec[4]*df[i,4] +vec[5]*df[i,5] + vec[6]*df[i,6]
}
return(ind)
}
scores <- eig$vectors[,1]
ind <- indice(df,scores)
(ind <- round(100/as.numeric(ind),3))
nomgeo <- c("Álvaro Obregón", "Azcapotzalco", "Benito Juárez", "Coyoacán", "Cuajimalpa de Morelos", "Cuauhtémoc", "Gustavo A. Madero","Iztacalco","Iztapalapa","La Magdalena Contreras", "Miguel Hidalgo", "Milpa Alta", "Tláhuac", "Tlalpan", "Venustiano Carranza", "Xochimilco")
index <- data.frame(nomgeo,ind)
mapa<-st_read("alcaldias/alcaldias.shp",stringsAsFactors=FALSE)
str(mapa)
mapa_datos <- inner_join(mapa,index, by="nomgeo")
str(mapa_datos)
tm_shape(mapa_datos)+
tm_polygons("ind",id="nomgeo",plette="Reds")
tmap_mode("view")
tmap_last()
