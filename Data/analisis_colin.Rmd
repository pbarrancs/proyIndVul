---
title: "Proy tío Jorge"
output:
  html_document:
    df_print: paged
  html_notebook: default
  pdf_document: default
---

Cargamos los datos:
```{r}
library(readr)
datos <- read_csv("BD.csv")
attach(datos)
```


Veamos primero la correlación por pares entre las variables explicativas:

```{r}
X<-datos[,5:15]
library(GGally)
ggpairs(X)
```

Las correlaciones son altas, parace haber colinearidad en la mayoría, aunque no en todos. 

Nuevamente, al observar la matriz de coeficientes de correlación parcial entre las variables, también queda claro que la correlación parcial entre algunas variables.


```{r}
library(corpcor)
cor2pcor(cov(X))
```

Hagamos el Farrar – Glauber Test para medir colinearidad

```{r}
library(mctest)
omcdiag(X,Clave)
```

Se encuentra que el valor del determinante estandarizado es 0.0000, pequeñísimo. Se encuentra que el valor calculado de la estadística de prueba de Chi-cuadrado es 274.0104 y es altamente significativo, lo que implica la presencia de multicolinealidad en la especificación del modelo.

Busquemos dónde está la colinearidad:

```{r}
imcdiag(X,Clave)
```

La estadística F para Carencia_salud  es muy alta (320.6812), le sigue Ingreso_inferior (152.8558). Los grados de libertad de una F son (k-1, n-k)=(10, 6), entonces para estos grados de libertad con un nivel de significación del 5%, el valor teórico de F es 4.06, así que, la prueba de F muestra que Remuneracion (Millones de Pesos) es la única variable que no causa colinearidad.

Para examinar el patrón de multicolinealidad, se requiere realizar una prueba t para el coeficiente de correlación:

Paquete "ppcor" para calcular los coeficientes de correlación parcial junto con el estadístico t y los valores p correspondientes
```{r}
library(ppcor)
pcor(X, method = "pearson")
```

Vemos otra vez que remuneración tiene la correlación más pequeña.

Empecemos con el análisis de cada variable por significancia estadística:

-Ingreso_inferior con Poblacion afiliada a servicios de salud (1) 

-Carencia_alimentos con Personal_Medico y Solicitudes_desempleo (2)

-Carencia_salud Casos Confirmados y Poblacion afiliada a servicios de salud  (2) 

-Carencia_servicios con Solicitudes_desempleo (1) 

-Solicitudes_desempleo con Ingreso_inferior, Carencia_servicios, Desempleados, Poblacion afiliada a servicios de salud (4) 

-Desempleados con Carencia_salud, Solicitudes_desempleo, Poblacion afiliada a servicios de salud  (3) X

-Camas con nada (0) 

-Personal_Medico con nada (0) 

-Casos Confirmados con Carencia_salud (1)

-Remuneracion (Millones de Pesos) con Carencia_servicios (1) 

-Poblacion afiliada a servicios de salud con Ingreso_inferior,Carencia_salud, Solicitudes_desempleo y Desempleados (4)

Yo dejaría  Carencias alimentos, remuneraciones, población afiliada, carencias de servicios.

o carencia de servicios, desempleados, remuneraciones y población afiliada

o carencia de servicios, solicitudes de desempleo, emuneraciones y población afiliada

Volvemos a hacer el análisis con la primera propuesta:

```{r}
Y<-X[,c(2,10,11,4)]
omcdiag(Y,Clave)
```

```{r}
Z<-X[,c(10,6,4,11)]
omcdiag(Z,Clave)
```

```{r}
W<-X[,c(10,5,4,11)]
omcdiag(W,Clave)
```


```{r}
imcdiag(Y,Clave)
imcdiag(Z,Clave)
imcdiag(W,Clave)
```

Primera opción es la mejor Carencias alimentos, remuneraciones, población afiliada, carencias de servicios.